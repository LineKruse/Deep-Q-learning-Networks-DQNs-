---
title: "DQN plots - Data Science Exam"
author: "Line Kruse"
date: "5/9/2020"
output: html_document
---


#Simulation run 1

```{r setup, include=FALSE}
library(pacman)
p_load(ggplot2, dplyr)

CP_1<- read.csv("~/Documents/Data Science/ExamProject - DQN Transfer Learning/lossCartPole_1.csv", header=FALSE)
MC_1<- read.csv("~/Documents/Data Science/ExamProject - DQN Transfer Learning/lossMountainCar_1.csv", header=FALSE)
TL_1<- read.csv("~/Documents/Data Science/ExamProject - DQN Transfer Learning/lossTransferModel_1.csv", header=FALSE)

colnames(CP_1)<- c("loss","episode")
colnames(MC_1)<- c("loss","episode")
colnames(TL_1)<- c("loss","episode")

CP_1$condition <- "CartPole"
MC_1$condition <- "MountainCar"
TL_1$condition <- "TransferLearning"

data = rbind(CP_1, MC_1, TL_1)


#Plot 1) - Run 1
p1 <- ggplot(data, aes(episode, loss))+
  geom_line(aes(color=condition))+
  theme_classic()+
  labs(title = "Second Layer with transferred weights", subtitle = "Input and output layer reinitialized")

```

#Simulation run 2

```{r}
CP_2<- read.csv("~/Documents/Data Science/ExamProject - DQN Transfer Learning/lossCartPole_2.csv", header=FALSE)
MC_2<- read.csv("~/Documents/Data Science/ExamProject - DQN Transfer Learning/lossMountainCar_2.csv", header=FALSE)
TL_2<- read.csv("~/Documents/Data Science/ExamProject - DQN Transfer Learning/lossTransferModel_2.csv", header=FALSE)

colnames(CP_2)<- c("loss","episode")
colnames(MC_2)<- c("loss","episode")
colnames(TL_2)<- c("loss","episode")

CP_2$condition <- "CartPole"
MC_2$condition <- "MountainCar"
TL_2$condition <- "TransferLearning"

data2 <- rbind(CP_2, MC_2, TL_2)

p2 <- ggplot(data2, aes(episode, loss))+
  geom_line(aes(color=condition))+
  theme_classic()+
  labs(title = "Second and Third Layer with transferred weights", subtitle = "Input and output layer reinitialized")

```

#Simulation run 3

```{r}
TL_3 <- read.csv("~/Documents/Data Science/ExamProject - DQN Transfer Learning/lossTransferModel_3.csv", header=FALSE)

colnames(TL_3) <- c("loss", "episode")

TL_3$condition <- "TransferLearning"

data3 <- rbind(CP_2, MC_2, TL_3)

p3 <- ggplot(data3, aes(episode, loss))+
  geom_line(aes(color=condition))+
  theme_classic()+
  labs(title = "Only third layer with transferred weights", subtitle = "Input, 1st layer, and output layer reinitialized")

#Compare tranferModel performance from run 2 to run 3
TL_2$run <- 2
TL_3$run <- 3
data4 <- rbind(TL_2, TL_3)
data4$run <- as.factor(data4$run)

p4 <- ggplot(data4, aes(episode, loss))+
  geom_line(aes(color=run))+
  theme_classic()+
  labs(title="Transfermodel in sim2 versus sim3")

```

#Compare Mountain Car using linear and softmax 

```{r}
MC_softmax <- read.csv("~/Documents/Data Science/ExamProject - DQN Transfer Learning/lossMountainCar_3_softmax.csv", header=FALSE)

colnames(MC_softmax) <- c("loss", "episode")
MC_softmax$condition <- "softmax"

MC_linear <- MC_2
MC_linear$condition <- "linear"

comp <- rbind(MC_linear, MC_softmax)

ggplot(comp, aes(episode, loss))+
  geom_line(aes(color=condition))+
  theme_classic()


```

#Simulation 4 and 5: Transfer for both middle layers from MC to CP 

```{r}
MC_4 <- read.csv("~/Documents/Data Science/ExamProject - DQN Transfer Learning/lossMountainCar_4.csv", header=FALSE)
CP_4 <- read.csv("~/Documents/Data Science/ExamProject - DQN Transfer Learning/lossCartPole_4.csv", header=FALSE)
TL_4 <- read.csv("~/Documents/Data Science/ExamProject - DQN Transfer Learning/lossTransferMCtoCP_4.csv", header=FALSE)
TL_5 <- read.csv("~/Documents/Data Science/ExamProject - DQN Transfer Learning/lossTransferMCtoCP_5.csv", header=FALSE)

colnames(MC_4) <- c("loss", "episode")
colnames(CP_4) <- c("loss", "episode")
colnames(TL_4) <- c("loss", "episode")
colnames(TL_5) <- c("loss", "episode")

MC_4$condition <- "MountainCar"
CP_4$condition <- "CartPole - no transfer"
TL_4$condition <- "CartPole - transfer"
TL_5$condition <- "Cartpole - transfer"

data4 <- rbind(MC_4, CP_4, TL_4)
data5 <- rbind(MC_4, CP_4, TL_5)

ggplot(data4, aes(episode, loss))+
  geom_line(aes(color=condition))+
  theme_classic()

ggplot(data5, aes(episode, loss))+
  geom_line(aes(color=condition))+
  theme_classic()

```

#Simulation 6) Transfer from cartpole to lunar lander 

```{r}
CP_6 <- read.csv("~/Documents/Data Science/ExamProject - DQN Transfer Learning/lossCartPole_6.csv", header=FALSE)
LL_6 <- read.csv("~/Documents/Data Science/ExamProject - DQN Transfer Learning/lossLunarLander_6.csv", header=FALSE)
TL_6 <- read.csv("~/Documents/Data Science/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_6.csv", header=FALSE)

colnames(CP_6) <- c("loss", "episode")
colnames(LL_6) <- c("loss", "episode")
colnames(TL_6) <- c("loss", "episode")


CP_6$condition <- "CartPole"
LL_6$condition <- "LunarLander: No transfer"
TL_6$condition <- "LunarLander: Transfer"

data6 <- rbind(LL_6, TL_6)

ggplot(data6, aes(episode, loss))+
  geom_line(aes(color=condition))+
  theme_classic()




```

#Simulation 6) Transfer two layers from CP to LL 

```{r}
CP_6 <- read.csv("~/Documents/Data Science/ExamProject - DQN Transfer Learning/lossCartPole_6.csv", header=FALSE)
LL_6 <- read.csv("~/Documents/Data Science/ExamProject - DQN Transfer Learning/lossLunarLander_6.csv", header=FALSE)
TL_6 <- read.csv("~/Documents/Data Science/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_6.csv", header=FALSE)

colnames(LL_6) <- c("loss", "episode")
colnames(TL_6) <- c("loss", "episode")

LL_6$condition <- "LunarLander: No transfer"
TL_6$condition <- "LunarLander: Transfer"

data6 <- rbind(LL_6, TL_6)

ggplot(data6, aes(episode, loss))+
  geom_line(aes(color=condition))+
  theme_classic()

```

#Simulation 8) Transfer one layer from CP to LL 

```{r}
LL_8 <- read.csv("~/Documents/Data Science/ExamProject - DQN Transfer Learning/lossLunarLander_6.csv", header=FALSE)
TL_8 <- read.csv("~/Documents/Data Science/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_8.csv", header=FALSE)

colnames(LL_8) <- c("loss", "episode")
colnames(TL_8) <- c("loss", "episode")

LL_8$condition <- "LunarLander: No transfer"
TL_8$condition <- "LunarLander: Transfer"

data8 <- rbind(LL_8, TL_8)

ggplot(data8, aes(episode, loss))+
  geom_line(aes(color=condition))+
  theme_classic()
```


#Comparison of both models to baseline 
```{r}
#Mean performance in condition 1 = df_6
#Mean performance in condition 2 = df_7
#Mean performance in condition 3 = df_8
#Mean performance in condition 4 = df_9

#Load and clean random data - Cartpole
CP_rand_1 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_Random_1.csv", header=FALSE)
CP_rand_2 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_Random_2.csv", header=FALSE)
CP_rand_3 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_Random_3.csv", header=FALSE)
CP_rand_4 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_Random_4.csv", header=FALSE)
CP_rand_5 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_Random_5.csv", header=FALSE)
CP_rand_6 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_Random_6.csv", header=FALSE)
CP_rand_7 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_Random_7.csv", header=FALSE)
CP_rand_8 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_Random_8.csv", header=FALSE)


colnames(CP_rand_1) <- c("sim1", "episode")

CP_rand_2 <- select(CP_rand_2, 1)
CP_rand_3 <- select(CP_rand_3, 1)
CP_rand_4 <- select(CP_rand_4, 1)
CP_rand_5 <- select(CP_rand_5, 1)
CP_rand_6 <- select(CP_rand_6, 1)
CP_rand_7 <- select(CP_rand_7, 1)
CP_rand_8 <- select(CP_rand_8, 1)

colnames(CP_rand_2) <- "sim2"
colnames(CP_rand_3) <- "sim3"
colnames(CP_rand_4) <- "sim4"
colnames(CP_rand_5) <- "sim5"
colnames(CP_rand_6) <- "sim6"
colnames(CP_rand_7) <- "sim7"
colnames(CP_rand_8) <- "sim8"


CP_rand <- cbind(CP_rand_1, CP_rand_2, CP_rand_3, CP_rand_4, CP_rand_5, CP_rand_6, CP_rand_7, CP_rand_8)

#Add column with summary of the five sims for each episode 
CP_rand$mean = rowMeans(CP_rand[,c(-2)])

#Add condition info to this dataset (later to be merged with other)
CP_rand$condition <- "CartPole: Random"



#Load and clean random data - Lunar Lander 
LL_rand_1 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_Random_1.csv", header=FALSE)
LL_rand_2 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_Random_2.csv", header=FALSE)
LL_rand_3 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_Random_3.csv", header=FALSE)
LL_rand_4 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_Random_4.csv", header=FALSE)
LL_rand_5 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_Random_5.csv", header=FALSE)
LL_rand_6 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_Random_6.csv", header=FALSE)
LL_rand_7 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_Random_7.csv", header=FALSE)
LL_rand_8 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_Random_8.csv", header=FALSE)

colnames(LL_rand_1) <- c("sim1", "episode")

LL_rand_2 <- select(LL_rand_2, 1)
LL_rand_3 <- select(LL_rand_3, 1)
LL_rand_4 <- select(LL_rand_4, 1)
LL_rand_5 <- select(LL_rand_5, 1)
LL_rand_6 <- select(LL_rand_6, 1)
LL_rand_7 <- select(LL_rand_7, 1)
LL_rand_8 <- select(LL_rand_8, 1)


colnames(LL_rand_2) <- "sim2"
colnames(LL_rand_3) <- "sim3"
colnames(LL_rand_4) <- "sim4"
colnames(LL_rand_5) <- "sim5"
colnames(LL_rand_6) <- "sim6"
colnames(LL_rand_7) <- "sim7"
colnames(LL_rand_8) <- "sim8"


LL_rand <- cbind(LL_rand_1, LL_rand_2, LL_rand_3, LL_rand_4, LL_rand_5, LL_rand_6,LL_rand_7, LL_rand_8)

#Add column with summary of the five sims for each episode 
LL_rand$mean = rowMeans(LL_rand[,c(-2)])

#Add condition info to this dataset (later to be merged with other)
LL_rand$condition <- "LunarLander: Random"



#Bind all data together - both random and models 
baseline_df <- rbind(df_6, df_7, df_8, df_9, CP_rand, LL_rand)
baseline_2DQN <- rbind(df_6, CP_rand, LL_rand)
baseline_3DQN <- rbind(df_7, df_8, df_9, CP_rand, LL_rand)

baseline_CP <- baseline_df[baseline_df$condition == "CartPole" | baseline_df$condition=="CartPole: Random",]
baseline_LL <- baseline_df[baseline_df$condition == "LunarLander" | baseline_df$condition=="LunarLander: Random",]

baseline_CP_2DQN <- baseline_2DQN[baseline_2DQN$condition == "CartPole" | baseline_2DQN$condition=="CartPole: Random",]
baseline_LL_2DQN <- baseline_2DQN[baseline_2DQN$condition == "LunarLander" | baseline_2DQN$condition=="LunarLander: Random",]

baseline_CP_3DQN <- baseline_3DQN[baseline_3DQN$condition == "CartPole" | baseline_3DQN$condition=="CartPole: Random",]
baseline_LL_3DQN <- baseline_3DQN[baseline_3DQN$condition == "LunarLander" | baseline_3DQN$condition=="LunarLander: Random",]

test_9 <- rbind(df_9, LL_rand)
test_9 <- test_9[test_9$condition == "LunarLander" | test_9$condition=="LunarLander: Random",]

ggplot(test_9, aes(episode, mean))+ 
  geom_line(aes(color=condition))+
  theme_classic()+
  labs(title="Performance of DQN versus random policy")

#Plot - comparison of DQN agains random policy 
ggplot(baseline_df, aes(episode, mean))+
  geom_line(aes(color=condition))+
  theme_classic()+
  labs(title="Performance of DQN versus random policy")

p1_rand_CP_2DQN <- ggplot(baseline_CP_2DQN, aes(episode, mean))+
  geom_line(aes(color=condition))+
  theme_classic()+
  labs(title="A")+
  theme(legend.title = element_blank())

p1_rand_LL_2DQN <- ggplot(baseline_LL_2DQN, aes(episode, mean))+
  geom_line(aes(color=condition))+
  theme_classic()+
  labs(title="B")+
  theme(legend.title = element_blank())

p1_rand_CP_3DQN <- ggplot(baseline_CP_3DQN, aes(episode, mean))+
  geom_line(aes(color=condition))+
  theme_classic()+
  labs(title="C")+ 
  theme(legend.title = element_blank())

p1_rand_LL_3DQN <- ggplot(baseline_LL_3DQN, aes(episode, mean))+
  geom_line(aes(color=condition))+
  theme_classic()+
  labs(title="D")+ 
  theme(legend.title = element_blank())


```


#Full data (5 sims) - Simulation 6 - 2 hidden layers, transfer from layer 2 

```{r}

######### CartPole ##########
#Load and clean 
CP_6_1 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_6_1.csv", header=FALSE)
CP_6_2 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_6_2.csv", header=FALSE)
CP_6_3 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_6_3.csv", header=FALSE)
CP_6_4 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_6_4.csv", header=FALSE)
CP_6_5 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_6_5.csv", header=FALSE)
CP_6_6 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_6_6.csv", header=FALSE)
CP_6_7 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_6_7.csv", header=FALSE)
CP_6_8 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_6_8.csv", header=FALSE)

#Create df with one column for each simulation scores
colnames(CP_6_1) <- c("sim1", "episode")

CP_6_2 <- select(CP_6_2, 1)
CP_6_3 <- select(CP_6_3, 1)
CP_6_4 <- select(CP_6_4, 1)
CP_6_5 <- select(CP_6_5, 1)
CP_6_6 <- select(CP_6_6, 1)
CP_6_7 <- select(CP_6_7, 1)
CP_6_8 <- select(CP_6_8, 1)

colnames(CP_6_2) <- "sim2"
colnames(CP_6_3) <- "sim3"
colnames(CP_6_4) <- "sim4"
colnames(CP_6_5) <- "sim5"
colnames(CP_6_6) <- "sim6"
colnames(CP_6_7) <- "sim7"
colnames(CP_6_8) <- "sim8"


CP_df <- cbind(CP_6_1, CP_6_2, CP_6_3, CP_6_4, CP_6_5, CP_6_6, CP_6_7, CP_6_8)

#Add column with summary of the five sims for each episode 
CP_df$mean = rowMeans(CP_df[,c(-2)])

#Add condition info to this dataset (later to be merged with other)
CP_df$condition <- "CartPole"

#Make df with column for average over last 100 episodes

avr100 <- function(df){
  df$avr100 <- NA
  for (i in 1:nrow(df)){
    if(i<=100){
      df$avr100[i] <- mean(df[1:i,1])}
    else{
      df$avr100[i] <- mean(df[(i-99):i,1])
    }
  }
  return(df)
}

CP_6_1_avr <- avr100(CP_6_1)
CP_6_2_avr <- avr100(CP_6_2)
CP_6_3_avr <- avr100(CP_6_3)
CP_6_4_avr <- avr100(CP_6_4)
CP_6_5_avr <- avr100(CP_6_5)
CP_6_6_avr <- avr100(CP_6_6)
CP_6_7_avr <- avr100(CP_6_7)
CP_6_8_avr <- avr100(CP_6_8)

CP_6_2_avr$episode <- c(0:199)
CP_6_3_avr$episode <- c(0:199)
CP_6_4_avr$episode <- c(0:199)
CP_6_5_avr$episode <- c(0:199)
CP_6_6_avr$episode <- c(0:199)
CP_6_7_avr$episode <- c(0:199)
CP_6_8_avr$episode <- c(0:199)

CP_6_1_avr$condition <- "Cond1:Run1"
CP_6_2_avr$condition <- "Cond1:Run2"
CP_6_3_avr$condition <- "Cond1:Run3"
CP_6_4_avr$condition <- "Cond1:Run4"
CP_6_5_avr$condition <- "Cond1:Run5"
CP_6_6_avr$condition <- "Cond1:Run6"
CP_6_7_avr$condition <- "Cond1:Run7"
CP_6_8_avr$condition <- "Cond1:Run8"

CP_6_1_avr$environment <- "CartPole"
CP_6_2_avr$environment <- "CartPole"
CP_6_3_avr$environment <- "CartPole"
CP_6_4_avr$environment <- "CartPole"
CP_6_5_avr$environment <- "CartPole"
CP_6_6_avr$environment <- "CartPole"
CP_6_7_avr$environment <- "CartPole"
CP_6_8_avr$environment <- "CartPole"

CP_6_1_avr<- select(CP_6_1_avr,-1)
CP_6_2_avr<- select(CP_6_2_avr,-1)
CP_6_3_avr<- select(CP_6_3_avr,-1)
CP_6_4_avr<- select(CP_6_4_avr,-1)
CP_6_5_avr<- select(CP_6_5_avr,-1)
CP_6_6_avr<- select(CP_6_6_avr,-1)
CP_6_7_avr<- select(CP_6_7_avr,-1)
CP_6_8_avr<- select(CP_6_8_avr,-1)






######### LunarLander - no Transfer ##########
#Load and clean 
LL_6_1 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_6_1.csv", header=FALSE)
LL_6_2 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_6_2.csv", header=FALSE)
LL_6_3 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_6_3.csv", header=FALSE)
LL_6_4 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_6_4.csv", header=FALSE)
LL_6_5 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_6_5.csv", header=FALSE)
LL_6_6 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_6_6.csv", header=FALSE)
LL_6_7 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_6_7.csv", header=FALSE)
LL_6_8 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_6_8.csv", header=FALSE)


#Create df with one column for each simulation scores
colnames(LL_6_1) <- c("sim1", "episode")

LL_6_2 <- select(LL_6_2, 1)
LL_6_3 <- select(LL_6_3, 1)
LL_6_4 <- select(LL_6_4, 1)
LL_6_5 <- select(LL_6_5, 1)
LL_6_6 <- select(LL_6_6, 1)
LL_6_7 <- select(LL_6_7, 1)
LL_6_8 <- select(LL_6_8, 1)

colnames(LL_6_2) <- "sim2"
colnames(LL_6_3) <- "sim3"
colnames(LL_6_4) <- "sim4"
colnames(LL_6_5) <- "sim5"
colnames(LL_6_6) <- "sim6"
colnames(LL_6_7) <- "sim7"
colnames(LL_6_8) <- "sim8"

nrow(LL_6_8)

#Since the agent solved the task in 197 steps in sim7, we add the score on episode 197 to the remaining 3 trials (so that the df has 200 rows as the others)
nrow(TL_6_7) #167 rows
add_6_7 <- data.frame(sim7 = rep(253.397,3))
LL_6_7 <- rbind(LL_6_7, add_6_7)

LL_df <- cbind(LL_6_1, LL_6_2, LL_6_3, LL_6_4, LL_6_5, LL_6_6, LL_6_7, LL_6_8)

#Add column with summary of the five sims for each episode 
LL_df$mean = rowMeans(LL_df[,c(-2)])

#Add condition info to this dataset (later to be merged with other)
LL_df$condition <- "LunarLander"

#Make df with columnn for average over last 100 episode 
LL_6_1_avr <- avr100(LL_6_1)
LL_6_2_avr <- avr100(LL_6_2)
LL_6_3_avr <- avr100(LL_6_3)
LL_6_4_avr <- avr100(LL_6_4)
LL_6_5_avr <- avr100(LL_6_5)
LL_6_6_avr <- avr100(LL_6_6)
LL_6_7_avr <- avr100(LL_6_7)
LL_6_8_avr <- avr100(LL_6_8)

LL_6_2_avr$episode <- c(0:199)
LL_6_3_avr$episode <- c(0:199)
LL_6_4_avr$episode <- c(0:199)
LL_6_5_avr$episode <- c(0:199)
LL_6_6_avr$episode <- c(0:199)
LL_6_7_avr$episode <- c(0:199)
LL_6_8_avr$episode <- c(0:199)

LL_6_1_avr$condition <- "LL:Cond1:Run1"
LL_6_2_avr$condition <- "LL:Cond1:Run2"
LL_6_3_avr$condition <- "LL:Cond1:Run3"
LL_6_4_avr$condition <- "LL:Cond1:Run4"
LL_6_5_avr$condition <- "LL:Cond1:Run5"
LL_6_6_avr$condition <- "LL:Cond1:Run6"
LL_6_7_avr$condition <- "LL:Cond1:Run7"
LL_6_8_avr$condition <- "LL:Cond1:Run8"

LL_6_1_avr$environment <- "LunarLander: No transfer"
LL_6_2_avr$environment <- "LunarLander: No transfer"
LL_6_3_avr$environment <- "LunarLander: No transfer"
LL_6_4_avr$environment <- "LunarLander: No transfer"
LL_6_5_avr$environment <- "LunarLander: No transfer"
LL_6_6_avr$environment <- "LunarLander: No transfer"
LL_6_7_avr$environment <- "LunarLander: No transfer"
LL_6_8_avr$environment <- "LunarLander: No transfer"

LL_6_1_avr<- select(LL_6_1_avr,-1)
LL_6_2_avr<- select(LL_6_2_avr,-1)
LL_6_3_avr<- select(LL_6_3_avr,-1)
LL_6_4_avr<- select(LL_6_4_avr,-1)
LL_6_5_avr<- select(LL_6_5_avr,-1)
LL_6_6_avr<- select(LL_6_6_avr,-1)
LL_6_7_avr<- select(LL_6_7_avr,-1)
LL_6_8_avr<- select(LL_6_8_avr,-1)





######### LunarLander - Transfer learning ##########
#Load and clean 
TL_6_1 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_6_1.csv", header=FALSE)
TL_6_2 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_6_2.csv", header=FALSE)
TL_6_3 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_6_3.csv", header=FALSE)
TL_6_4 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_6_4.csv", header=FALSE)
TL_6_5 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_6_5.csv", header=FALSE)
TL_6_6 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_6_6.csv", header=FALSE)
TL_6_7 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_6_7.csv", header=FALSE)
TL_6_8 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_6_8.csv", header=FALSE)


#Create df with one column for each simulation scores
colnames(TL_6_1) <- c("sim1", "episode")

TL_6_2 <- select(TL_6_2, 1)
TL_6_3 <- select(TL_6_3, 1)
TL_6_4 <- select(TL_6_4, 1)
TL_6_5 <- select(TL_6_5, 1)
TL_6_6 <- select(TL_6_6, 1)
TL_6_7 <- select(TL_6_7, 1)
TL_6_8 <- select(TL_6_8, 1)

colnames(TL_6_2) <- "sim2"
colnames(TL_6_3) <- "sim3"
colnames(TL_6_4) <- "sim4"
colnames(TL_6_5) <- "sim5"
colnames(TL_6_6) <- "sim6"
colnames(TL_6_7) <- "sim7"
colnames(TL_6_8) <- "sim8"

#Since the agent solved the task in 167 steps in sim3, we add the score on episode 167 to the remaining 33 trials (so that the df has 200 rows as the others)
nrow(TL_6_6) #167 rows
add_6_3 <- data.frame(sim3 = rep(288.5,33))
TL_6_3 <- rbind(TL_6_3, add_6_3)

add_6_6 <- data.frame(sim6=rep(241.369,1))
TL_6_6 <- rbind(TL_6_6, add_6_6)

#Combine all dfs 
TL_df <- cbind(TL_6_1, TL_6_2, TL_6_3, TL_6_4, TL_6_5, TL_6_6, TL_6_7, TL_6_8)

#Add column with summary of the five sims for each episode 
TL_df$mean = rowMeans(TL_df[,c(-2)])

#Add condition info to this dataset (later to be merged with other)
TL_df$condition <- "LunarLander_Transfer"

#Make DF with column for average over last 100 episodes 
TL_6_1_avr <- avr100(TL_6_1)
TL_6_2_avr <- avr100(TL_6_2)
TL_6_3_avr <- avr100(TL_6_3)
TL_6_4_avr <- avr100(TL_6_4)
TL_6_5_avr <- avr100(TL_6_5)
TL_6_6_avr <- avr100(TL_6_6)
TL_6_7_avr <- avr100(TL_6_7)
TL_6_8_avr <- avr100(TL_6_8)

TL_6_2_avr$episode <- c(0:199)
TL_6_3_avr$episode <- c(0:199)
TL_6_4_avr$episode <- c(0:199)
TL_6_5_avr$episode <- c(0:199)
TL_6_6_avr$episode <- c(0:199)
TL_6_7_avr$episode <- c(0:199)
TL_6_8_avr$episode <- c(0:199)

TL_6_1_avr$condition <- "TL:Cond1:Run1"
TL_6_2_avr$condition <- "TL:Cond1:Run2"
TL_6_3_avr$condition <- "TL:Cond1:Run3"
TL_6_4_avr$condition <- "TL:Cond1:Run4"
TL_6_5_avr$condition <- "TL:Cond1:Run5"
TL_6_6_avr$condition <- "TL:Cond1:Run6"
TL_6_7_avr$condition <- "TL:Cond1:Run7"
TL_6_8_avr$condition <- "TL:Cond1:Run8"

TL_6_1_avr$environment <- "LunarLander: Transfer"
TL_6_2_avr$environment <- "LunarLander: Transfer"
TL_6_3_avr$environment <- "LunarLander: Transfer"
TL_6_4_avr$environment <- "LunarLander: Transfer"
TL_6_5_avr$environment <- "LunarLander: Transfer"
TL_6_6_avr$environment <- "LunarLander: Transfer"
TL_6_7_avr$environment <- "LunarLander: Transfer"
TL_6_8_avr$environment <- "LunarLander: Transfer"

TL_6_1_avr<- select(TL_6_1_avr,-1)
TL_6_2_avr<- select(TL_6_2_avr,-1)
TL_6_3_avr<- select(TL_6_3_avr,-1)
TL_6_4_avr<- select(TL_6_4_avr,-1)
TL_6_5_avr<- select(TL_6_5_avr,-1)
TL_6_6_avr<- select(TL_6_6_avr,-1)
TL_6_7_avr<- select(TL_6_7_avr,-1)
TL_6_8_avr<- select(TL_6_8_avr,-1)


###### Combine all data ############## 
df_6 <- rbind(CP_df, LL_df, TL_df) #For plotting performance over time (slope)
df_6_avr <- rbind(LL_6_1_avr, LL_6_2_avr, LL_6_3_avr, LL_6_4_avr, LL_6_5_avr, LL_6_6_avr, LL_6_7_avr, LL_6_8_avr, TL_6_1_avr,TL_6_2_avr, TL_6_3_avr, TL_6_4_avr, TL_6_5_avr, TL_6_6_avr, TL_6_7_avr, TL_6_8_avr)

########## Plots ############ 
#Plot performance over time for each of the three conditions
p2_performance_time_cond1 <- ggplot(df_6, aes(episode, mean))+
  geom_line(aes(color=condition))+
  theme_classic()+
  labs(title = "A")+
  theme(legend.title = element_blank())

#Plot average score over last 100 episodes for each simulation individually
p3_avr100_time_cond1 <- ggplot(df_6_avr, aes(episode, avr100))+
  geom_line(aes(color=environment))+
  theme_classic()+
  theme(legend.title = element_blank())+ 
  labs(title="A")
  geom_hline(yintercept = 200, color="black", linetype="dashed")

p4_solved_task_cond1 <- ggplot()+
  geom_line(data=df_6_avr[df_6_avr$condition=="LL:Cond1:Run1",],aes(episode, avr100, color=environment))+
  geom_line(data=df_6_avr[df_6_avr$condition=="LL:Cond1:Run2",],aes(episode, avr100, color=environment))+
  geom_line(data=df_6_avr[df_6_avr$condition=="LL:Cond1:Run3",],aes(episode, avr100, color=environment))+
  geom_line(data=df_6_avr[df_6_avr$condition=="LL:Cond1:Run4",],aes(episode, avr100, color=environment))+
  geom_line(data=df_6_avr[df_6_avr$condition=="LL:Cond1:Run5",],aes(episode, avr100, color=environment))+
  geom_line(data=df_6_avr[df_6_avr$condition=="LL:Cond1:Run6",],aes(episode, avr100, color=environment))+
  geom_line(data=df_6_avr[df_6_avr$condition=="LL:Cond1:Run7",],aes(episode, avr100, color=environment))+
  geom_line(data=df_6_avr[df_6_avr$condition=="LL:Cond1:Run8",],aes(episode, avr100, color=environment))+
  geom_line(data=df_6_avr[df_6_avr$condition=="TL:Cond1:Run1",],aes(episode, avr100, color=environment))+
  geom_line(data=df_6_avr[df_6_avr$condition=="TL:Cond1:Run2",],aes(episode, avr100, color=environment))+
  geom_line(data=df_6_avr[df_6_avr$condition=="TL:Cond1:Run3",],aes(episode, avr100, color=environment))+
  geom_line(data=df_6_avr[df_6_avr$condition=="TL:Cond1:Run4",],aes(episode, avr100, color=environment))+
  geom_line(data=df_6_avr[df_6_avr$condition=="TL:Cond1:Run5",],aes(episode, avr100, color=environment))+
  geom_line(data=df_6_avr[df_6_avr$condition=="TL:Cond1:Run6",],aes(episode, avr100, color=environment))+
  geom_line(data=df_6_avr[df_6_avr$condition=="TL:Cond1:Run7",],aes(episode, avr100, color=environment))+
  geom_line(data=df_6_avr[df_6_avr$condition=="TL:Cond1:Run8",],aes(episode, avr100, color=environment))+
  ylim(0,250)+
  xlim(100,200)+
  geom_hline(yintercept = 200, color="black", linetype="dashed")+
  labs(title="A")+
  theme_classic()




```

#Full data (5 sims) - Simulation 7 - 3 hidden layers, transfer from layer 2 and 3

```{r}
######### CartPole ##########
#Load and clean 
CP_7_1 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_7_1.csv", header=FALSE)
CP_7_2 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_7_2.csv", header=FALSE)
CP_7_3 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_7_3.csv", header=FALSE)
CP_7_4 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_7_4.csv", header=FALSE)
CP_7_5 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_7_5.csv", header=FALSE)
CP_7_6 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_7_6.csv", header=FALSE)
CP_7_7 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_7_7.csv", header=FALSE)
CP_7_8 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_7_8.csv", header=FALSE)


#Create df with one column for each simulation scores
colnames(CP_7_1) <- c("sim1", "episode")

CP_7_2 <- select(CP_7_2, 1)
CP_7_3 <- select(CP_7_3, 1)
CP_7_4 <- select(CP_7_4, 1)
CP_7_5 <- select(CP_7_5, 1)
CP_7_6 <- select(CP_7_6, 1)
CP_7_7 <- select(CP_7_7, 1)
CP_7_8 <- select(CP_7_8, 1)

colnames(CP_7_2) <- "sim2"
colnames(CP_7_3) <- "sim3"
colnames(CP_7_4) <- "sim4"
colnames(CP_7_5) <- "sim5"
colnames(CP_7_6) <- "sim6"
colnames(CP_7_7) <- "sim7"
colnames(CP_7_8) <- "sim8"

CP_df_7 <- cbind(CP_7_1, CP_7_2, CP_7_3, CP_7_4, CP_7_5, CP_7_6, CP_7_7, CP_7_8)

#Add column with summary of the five sims for each episode 
CP_df_7$mean = rowMeans(CP_df_7[,c(-2)])

#Add condition info to this dataset (later to be merged with other)
CP_df_7$condition <- "CartPole"

CP_df_7_mean <- CP_df_7[,c(2,10,11)]

#Make DF with column for average over last 100 episodes 
CP_7_1_avr <- avr100(CP_7_1)
CP_7_2_avr <- avr100(CP_7_2)
CP_7_3_avr <- avr100(CP_7_3)
CP_7_4_avr <- avr100(CP_7_4)
CP_7_5_avr <- avr100(CP_7_5)
CP_7_6_avr <- avr100(CP_7_6)
CP_7_7_avr <- avr100(CP_7_7)
CP_7_8_avr <- avr100(CP_7_8)


CP_7_2_avr$episode <- c(0:199)
CP_7_3_avr$episode <- c(0:199)
CP_7_4_avr$episode <- c(0:199)
CP_7_5_avr$episode <- c(0:199)
CP_7_6_avr$episode <- c(0:199)
CP_7_7_avr$episode <- c(0:199)
CP_7_8_avr$episode <- c(0:199)

CP_7_1_avr$condition <- "Cond2:Run1"
CP_7_2_avr$condition <- "Cond2:Run2"
CP_7_3_avr$condition <- "Cond2:Run3"
CP_7_4_avr$condition <- "Cond2:Run4"
CP_7_5_avr$condition <- "Cond2:Run5"
CP_7_6_avr$condition <- "Cond2:Run6"
CP_7_7_avr$condition <- "Cond2:Run7"
CP_7_8_avr$condition <- "Cond2:Run8"

CP_7_1_avr$environment <- "CartPole"
CP_7_2_avr$environment <- "CartPole"
CP_7_3_avr$environment <- "CartPole"
CP_7_4_avr$environment <- "CartPole"
CP_7_5_avr$environment <- "CartPole"
CP_7_6_avr$environment <- "CartPole"
CP_7_7_avr$environment <- "CartPole"
CP_7_8_avr$environment <- "CartPole"

CP_7_1_avr<- select(CP_7_1_avr,-1)
CP_7_2_avr<- select(CP_7_2_avr,-1)
CP_7_3_avr<- select(CP_7_3_avr,-1)
CP_7_4_avr<- select(CP_7_4_avr,-1)
CP_7_5_avr<- select(CP_7_5_avr,-1)
CP_7_6_avr<- select(CP_7_6_avr,-1)
CP_7_7_avr<- select(CP_7_7_avr,-1)
CP_7_8_avr<- select(CP_7_8_avr,-1)


######### LunarLander - no Transfer ##########
#Load and clean 
LL_7_1 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_7_1.csv", header=FALSE)
LL_7_2 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_7_2.csv", header=FALSE)
LL_7_3 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_7_3.csv", header=FALSE)
LL_7_4 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_7_4.csv", header=FALSE)
LL_7_5 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_7_5.csv", header=FALSE)
LL_7_6 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_7_6.csv", header=FALSE)
LL_7_7 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_7_7.csv", header=FALSE)
LL_7_8 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_7_8.csv", header=FALSE)
LL_8_1 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_8_1.csv", header=FALSE)
LL_8_2 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_8_2.csv", header=FALSE)
LL_8_3 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_8_3.csv", header=FALSE)
LL_8_4 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_8_4.csv", header=FALSE)
LL_8_5 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_8_5.csv", header=FALSE)
LL_8_6 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_8_6.csv", header=FALSE)
LL_8_7 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_8_7.csv", header=FALSE)
LL_8_8 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_8_8.csv", header=FALSE)
LL_9_1 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_9_1.csv", header=FALSE)
LL_9_2 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_9_2.csv", header=FALSE)
LL_9_3 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_9_3.csv", header=FALSE)
LL_9_4 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_9_4.csv", header=FALSE)
LL_9_5 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_9_5.csv", header=FALSE)
LL_9_6 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_9_6.csv", header=FALSE)
LL_9_7 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_9_7.csv", header=FALSE)
LL_9_8 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossLunarLander_9_8.csv", header=FALSE)


#Create df with one column for each simulation scores
colnames(LL_7_1) <- c("sim1", "episode")

LL_7_2 <- select(LL_7_2, 1)
LL_7_3 <- select(LL_7_3, 1)
LL_7_4 <- select(LL_7_4, 1)
LL_7_5 <- select(LL_7_5, 1)
LL_7_6 <- select(LL_7_6, 1)
LL_7_7 <- select(LL_7_7, 1)
LL_7_8 <- select(LL_7_8, 1)
LL_8_1 <- select(LL_8_1, 1)
LL_8_2 <- select(LL_8_2, 1)
LL_8_3 <- select(LL_8_3, 1)
LL_8_4 <- select(LL_8_4, 1)
LL_8_5 <- select(LL_8_5, 1)
LL_8_6 <- select(LL_8_6, 1)
LL_8_7 <- select(LL_8_7, 1)
LL_8_8 <- select(LL_8_8, 1)
LL_9_1 <- select(LL_9_1, 1)
LL_9_2 <- select(LL_9_2, 1)
LL_9_3 <- select(LL_9_3, 1)
LL_9_4 <- select(LL_9_4, 1)
LL_9_5 <- select(LL_9_5, 1)
LL_9_6 <- select(LL_9_6, 1)
LL_9_7 <- select(LL_9_7, 1)
LL_9_8 <- select(LL_9_8, 1)

colnames(LL_7_2) <- "sim2"
colnames(LL_7_3) <- "sim3"
colnames(LL_7_4) <- "sim4"
colnames(LL_7_5) <- "sim5"
colnames(LL_7_6) <- "sim6"
colnames(LL_7_7) <- "sim7"
colnames(LL_7_8) <- "sim8"
colnames(LL_8_1) <- "sim1"
colnames(LL_8_2) <- "sim2"
colnames(LL_8_3) <- "sim3"
colnames(LL_8_4) <- "sim4"
colnames(LL_8_5) <- "sim5"
colnames(LL_8_6) <- "sim6"
colnames(LL_8_7) <- "sim7"
colnames(LL_8_8) <- "sim8"
colnames(LL_9_1) <- "sim1"
colnames(LL_9_2) <- "sim2"
colnames(LL_9_3) <- "sim3"
colnames(LL_9_4) <- "sim4"
colnames(LL_9_5) <- "sim5"
colnames(LL_9_6) <- "sim6"
colnames(LL_9_7) <- "sim7"
colnames(LL_9_8) <- "sim8"

#Sim 3 the agent solved the task in 186 rows. Add the final score to remaining rows, so the df get length=200. 
nrow(LL_7_8 )
add_7_3 <- data.frame(sim3=rep(263.2,14))
LL_7_3 <- rbind(LL_7_3, add_7_3)

add_8_3 <- data.frame(sim3 = rep(242.616298,46))
LL_8_3 <- rbind(LL_8_3, add_8_3)

add_8_5 <- data.frame(sim5 = rep(225.089314,59))
LL_8_5 <- rbind(LL_8_5, add_8_5)

#Combine all 
LL_df_all <- cbind(LL_7_1, LL_7_2, LL_7_3, LL_7_4, LL_7_5, LL_7_6, LL_7_7, LL_7_8, LL_8_1, LL_8_2,LL_8_3, LL_8_4, LL_8_5, LL_8_6, LL_8_7, LL_8_8, LL_9_1, LL_9_2, LL_9_3, LL_9_4, LL_9_5, LL_9_6, LL_9_7, LL_9_8)


#Add column with summary of the five sims for each episode 
LL_df_all$mean = rowMeans(LL_df_all[,c(-2)])


#Add condition info to this dataset (later to be merged with other)
LL_df_all$condition <- "LunarLander"

LL_df_all_mean <- LL_df_all[,c(2,26,27)]

#Make DF with column for average over last 100 episodes 
LL_7_1_avr <- avr100(LL_7_1)
LL_7_2_avr <- avr100(LL_7_2)
LL_7_3_avr <- avr100(LL_7_3)
LL_7_4_avr <- avr100(LL_7_4)
LL_7_5_avr <- avr100(LL_7_5)
LL_7_6_avr <- avr100(LL_7_6)
LL_7_7_avr <- avr100(LL_7_7)
LL_7_8_avr <- avr100(LL_7_8)


LL_7_2_avr$episode <- c(0:199)
LL_7_3_avr$episode <- c(0:199)
LL_7_4_avr$episode <- c(0:199)
LL_7_5_avr$episode <- c(0:199)
LL_7_6_avr$episode <- c(0:199)
LL_7_7_avr$episode <- c(0:199)
LL_7_8_avr$episode <- c(0:199)

LL_7_1_avr$condition <- "LL:Cond2:Run1"
LL_7_2_avr$condition <- "LL:Cond2:Run2"
LL_7_3_avr$condition <- "LL:Cond2:Run3"
LL_7_4_avr$condition <- "LL:Cond2:Run4"
LL_7_5_avr$condition <- "LL:Cond2:Run5"
LL_7_6_avr$condition <- "LL:Cond2:Run6"
LL_7_7_avr$condition <- "LL:Cond2:Run7"
LL_7_8_avr$condition <- "LL:Cond2:Run8"

LL_7_1_avr$environment <- "LunarLander: No Transfer"
LL_7_2_avr$environment <- "LunarLander: No Transfer"
LL_7_3_avr$environment <- "LunarLander: No Transfer"
LL_7_4_avr$environment <- "LunarLander: No Transfer"
LL_7_5_avr$environment <- "LunarLander: No Transfer"
LL_7_6_avr$environment <- "LunarLander: No Transfer"
LL_7_7_avr$environment <- "LunarLander: No Transfer"
LL_7_8_avr$environment <- "LunarLander: No Transfer"

LL_7_1_avr<- select(LL_7_1_avr,-1)
LL_7_2_avr<- select(LL_7_2_avr,-1)
LL_7_3_avr<- select(LL_7_3_avr,-1)
LL_7_4_avr<- select(LL_7_4_avr,-1)
LL_7_5_avr<- select(LL_7_5_avr,-1)
LL_7_6_avr<- select(LL_7_6_avr,-1)
LL_7_7_avr<- select(LL_7_7_avr,-1)
LL_7_8_avr<- select(LL_7_8_avr,-1)


######### LunarLander - Transfer learning ##########
#Load and clean 
TL_7_1 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_7_1.csv", header=FALSE)
TL_7_2 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_7_2.csv", header=FALSE)
TL_7_3 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_7_3.csv", header=FALSE)
TL_7_4 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_7_4.csv", header=FALSE)
TL_7_5 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_7_5.csv", header=FALSE)
TL_7_6 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_7_6.csv", header=FALSE)
TL_7_7 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_7_7.csv", header=FALSE)
TL_7_8 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_7_8.csv", header=FALSE)

#Create df with one column for each simulation scores
colnames(TL_7_1) <- c("sim1", "episode")

TL_7_2 <- select(TL_7_2, 1)
TL_7_3 <- select(TL_7_3, 1)
TL_7_4 <- select(TL_7_4, 1)
TL_7_5 <- select(TL_7_5, 1)
TL_7_6 <- select(TL_7_6, 1)
TL_7_7 <- select(TL_7_7, 1)
TL_7_8 <- select(TL_7_8, 1)

colnames(TL_7_2) <- "sim2"
colnames(TL_7_3) <- "sim3"
colnames(TL_7_4) <- "sim4"
colnames(TL_7_5) <- "sim5"
colnames(TL_7_6) <- "sim6"
colnames(TL_7_7) <- "sim7"
colnames(TL_7_8) <- "sim8"

#Since the agent solved the task in 164 steps in sim3, we add the score on episode 164 to the remaining trials (so that the df has 200 rows as the others)
nrow(TL_7_8) #164 rows
add_7_3 <- data.frame(sim3 = rep(260.5,36))
TL_7_3 <- rbind(TL_7_3, add_7_3)

add_7_6 <- data.frame(sim6 = rep(263.388,60))
TL_7_6 <- rbind(TL_7_6, add_7_6)

#Combine all dfs 
TL_df_7 <- cbind(TL_7_1, TL_7_2, TL_7_3, TL_7_4, TL_7_5, TL_7_6, TL_7_7, TL_7_8)

#Add column with summary of the five sims for each episode 
TL_df_7$mean = rowMeans(TL_df_7[,c(-2)])

#Add condition info to this dataset (later to be merged with other)
TL_df_7$condition <- "LunarLander_Transfer"

TL_df_7_mean <- TL_df_7[,c(2,10,11)]

#Make df with column for average score over last 100 episodes
TL_7_1_avr <- avr100(TL_7_1)
TL_7_2_avr <- avr100(TL_7_2)
TL_7_3_avr <- avr100(TL_7_3)
TL_7_4_avr <- avr100(TL_7_4)
TL_7_5_avr <- avr100(TL_7_5)
TL_7_6_avr <- avr100(TL_7_6)
TL_7_7_avr <- avr100(TL_7_7)
TL_7_8_avr <- avr100(TL_7_8)


TL_7_2_avr$episode <- c(0:199)
TL_7_3_avr$episode <- c(0:199)
TL_7_4_avr$episode <- c(0:199)
TL_7_5_avr$episode <- c(0:199)
TL_7_6_avr$episode <- c(0:199)
TL_7_7_avr$episode <- c(0:199)
TL_7_8_avr$episode <- c(0:199)


TL_7_1_avr$condition <- "TL:Cond2:Run1"
TL_7_2_avr$condition <- "TL:Cond2:Run2"
TL_7_3_avr$condition <- "TL:Cond2:Run3"
TL_7_4_avr$condition <- "TL:Cond2:Run4"
TL_7_5_avr$condition <- "TL:Cond2:Run5"
TL_7_6_avr$condition <- "TL:Cond2:Run6"
TL_7_7_avr$condition <- "TL:Cond2:Run7"
TL_7_8_avr$condition <- "TL:Cond2:Run8"

TL_7_1_avr$environment <- "LunarLander: Transfer"
TL_7_2_avr$environment <- "LunarLander: Transfer"
TL_7_3_avr$environment <- "LunarLander: Transfer"
TL_7_4_avr$environment <- "LunarLander: Transfer"
TL_7_5_avr$environment <- "LunarLander: Transfer"
TL_7_6_avr$environment <- "LunarLander: Transfer"
TL_7_7_avr$environment <- "LunarLander: Transfer"
TL_7_8_avr$environment <- "LunarLander: Transfer"

TL_7_1_avr<- select(TL_7_1_avr,-1)
TL_7_2_avr<- select(TL_7_2_avr,-1)
TL_7_3_avr<- select(TL_7_3_avr,-1)
TL_7_4_avr<- select(TL_7_4_avr,-1)
TL_7_5_avr<- select(TL_7_5_avr,-1)
TL_7_6_avr<- select(TL_7_6_avr,-1)
TL_7_7_avr<- select(TL_7_7_avr,-1)
TL_7_8_avr<- select(TL_7_8_avr,-1)


###### Combine all data ############## 
df_7 <- rbind(CP_df_7, LL_df_7, TL_df_7)

df_7_mean <- rbind(CP_df_7_mean, LL_df_all_mean, TL_df_7_mean)


#Make df with average over 100 last episodes including all lunar lander runs (use in all plots - cond1-cond3)
avr1 <- cbind(LL_7_1_avr, LL_8_1_avr, LL_9_1_avr)
avr1$mean = rowMeans(avr1[,c(2,6,10)])
avr1 <- avr1[,c(1,3,4,13)]

avr2 <- cbind(LL_7_2_avr, LL_8_2_avr, LL_9_2_avr)
avr2$mean = rowMeans(avr2[,c(1,5,9)])
avr2 <- avr2[,c(2,3,4,13)]

avr3 <- cbind(LL_7_3_avr, LL_8_3_avr, LL_9_3_avr)
avr3$mean = rowMeans(avr3[,c(1,5,9)])
avr3 <- avr3[,c(2,3,4,13)]

avr4 <- cbind(LL_7_4_avr, LL_8_4_avr, LL_9_4_avr)
avr4$mean = rowMeans(avr4[,c(1,5,9)])
avr4 <- avr4[,c(2,3,4,13)]

avr5 <- cbind(LL_7_5_avr, LL_8_5_avr, LL_9_5_avr)
avr5$mean = rowMeans(avr5[,c(1,5,9)])
avr5 <- avr5[,c(2,3,4,13)]

avr6 <- cbind(LL_7_6_avr, LL_8_6_avr, LL_9_6_avr)
avr6$mean = rowMeans(avr6[,c(1,5,9)])
avr6 <- avr6[,c(2,3,4,13)]

avr7 <- cbind(LL_7_7_avr, LL_8_7_avr, LL_9_7_avr)
avr7$mean = rowMeans(avr7[,c(1,5,9)])
avr7 <- avr7[,c(2,3,4,13)]

avr8 <- cbind(LL_7_8_avr, LL_8_8_avr, LL_9_8_avr)
avr8$mean = rowMeans(avr8[,c(1,5,9)])
avr8 <- avr8[,c(2,3,4,13)]

LL_avr_all <- rbind(avr1, avr2, avr3, avr4, avr5, avr6, avr7, avr8)
colnames(LL_avr_all) <- c("episode", "condition", "environment", "avr100")


df_7_avr <- rbind(LL_avr_all,TL_7_1_avr,TL_7_2_avr, TL_7_3_avr, TL_7_4_avr, TL_7_5_avr, TL_7_6_avr, TL_7_7_avr, TL_7_8_avr)

########## Plots ############ 
p2_performance_time_cond2 <- ggplot(df_7_mean, aes(episode, mean))+
  geom_line(aes(color=condition))+
  theme_classic()+
  labs(title = "B")+
  theme(legend.title = element_blank())+ 
  geom_hline(yintercept = 200, color="black", linetype="dashed")

#Plot average score over last 100 episodes for each simulation individually
p3_avr100_time_cond2 <- ggplot(df_7_avr, aes(episode, avr100))+
  geom_line(aes(color=environment))+
  labs(title="B")+
  theme_classic()

p4_solved_task_cond2 <- ggplot()+
  #geom_line(data=df_7_avr[df_7_avr$condition=="LL:Cond2:Run1",],aes(episode, avr100, color=environment))+
  geom_line(data=df_7_avr[df_7_avr$condition=="LL:Cond2:Run2",],aes(episode, avr100, color=environment))+
  geom_line(data=df_7_avr[df_7_avr$condition=="LL:Cond2:Run3",],aes(episode, avr100, color=environment))+
  geom_line(data=df_7_avr[df_7_avr$condition=="LL:Cond2:Run4",],aes(episode, avr100, color=environment))+
  geom_line(data=df_7_avr[df_7_avr$condition=="LL:Cond2:Run5",],aes(episode, avr100, color=environment))+
  geom_line(data=df_7_avr[df_7_avr$condition=="LL:Cond2:Run6",],aes(episode, avr100, color=environment))+
  geom_line(data=df_7_avr[df_7_avr$condition=="LL:Cond2:Run7",],aes(episode, avr100, color=environment))+
  geom_line(data=df_7_avr[df_7_avr$condition=="LL:Cond2:Run8",],aes(episode, avr100, color=environment))+
  geom_line(data=df_7_avr[df_7_avr$condition=="TL:Cond2:Run1",],aes(episode, avr100, color=environment))+
  geom_line(data=df_7_avr[df_7_avr$condition=="TL:Cond2:Run2",],aes(episode, avr100, color=environment))+
  geom_line(data=df_7_avr[df_7_avr$condition=="TL:Cond2:Run3",],aes(episode, avr100, color=environment))+
  geom_line(data=df_7_avr[df_7_avr$condition=="TL:Cond2:Run4",],aes(episode, avr100, color=environment))+
  geom_line(data=df_7_avr[df_7_avr$condition=="TL:Cond2:Run5",],aes(episode, avr100, color=environment))+
  geom_line(data=df_7_avr[df_7_avr$condition=="TL:Cond2:Run6",],aes(episode, avr100, color=environment))+
  geom_line(data=df_7_avr[df_7_avr$condition=="TL:Cond2:Run7",],aes(episode, avr100, color=environment))+
  geom_line(data=df_7_avr[df_7_avr$condition=="TL:Cond2:Run8",],aes(episode, avr100, color=environment))+
  ylim(0,250)+
  xlim(100,200)+
  geom_hline(yintercept = 200, color="black", linetype="dashed")+
  labs(title="B")+
  theme_classic()+
  theme(legend.title = element_blank())

```

#Full data (5 sims) - Simulation 8 - 3 hidden layers, transfer from layer 2 only

```{r}
######### CartPole ##########
#Load and clean 
CP_8_1 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_8_1.csv", header=FALSE)
CP_8_2 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_8_2.csv", header=FALSE)
CP_8_3 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_8_3.csv", header=FALSE)
CP_8_4 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_8_4.csv", header=FALSE)
CP_8_5 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_8_5.csv", header=FALSE)
CP_8_6 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_8_6.csv", header=FALSE)
CP_8_7 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_8_7.csv", header=FALSE)
CP_8_8 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_8_8.csv", header=FALSE)


#Create df with one column for each simulation scores
colnames(CP_8_1) <- c("sim1", "episode")

CP_8_2 <- select(CP_8_2, 1)
CP_8_3 <- select(CP_8_3, 1)
CP_8_4 <- select(CP_8_4, 1)
CP_8_5 <- select(CP_8_5, 1)
CP_8_6 <- select(CP_8_6, 1)
CP_8_7 <- select(CP_8_7, 1)
CP_8_8 <- select(CP_8_8, 1)

colnames(CP_8_2) <- "sim2"
colnames(CP_8_3) <- "sim3"
colnames(CP_8_4) <- "sim4"
colnames(CP_8_5) <- "sim5"
colnames(CP_8_6) <- "sim6"
colnames(CP_8_7) <- "sim7"
colnames(CP_8_8) <- "sim8"

CP_df_8 <- cbind(CP_8_1, CP_8_2, CP_8_3, CP_8_4, CP_8_5, CP_8_6, CP_8_7, CP_8_8)

#Add column with summary of the five sims for each episode 
CP_df_8$mean = rowMeans(CP_df_8[,c(-2)])

#Add condition info to this dataset (later to be merged with other)
CP_df_8$condition <- "CartPole"

CP_df_8_mean <- CP_df_8[,c(2,10,11)]


######### LunarLander - no Transfer ##########

#Make df with column for average score over last 100 episodes
LL_8_1_avr <- avr100(LL_8_1)
LL_8_2_avr <- avr100(LL_8_2)
LL_8_3_avr <- avr100(LL_8_3)
LL_8_4_avr <- avr100(LL_8_4)
LL_8_5_avr <- avr100(LL_8_5)
LL_8_6_avr <- avr100(LL_8_6)
LL_8_7_avr <- avr100(LL_8_7)
LL_8_8_avr <- avr100(LL_8_8)

LL_8_1_avr$episode <- c(0,199)
LL_8_2_avr$episode <- c(0:199)
LL_8_3_avr$episode <- c(0:199)
LL_8_4_avr$episode <- c(0:199)
LL_8_5_avr$episode <- c(0:199)
LL_8_6_avr$episode <- c(0:199)
LL_8_7_avr$episode <- c(0:199)
LL_8_8_avr$episode <- c(0:199)


LL_8_1_avr$condition <- "LL:Cond3:Run1"
LL_8_2_avr$condition <- "LL:Cond3:Run2"
LL_8_3_avr$condition <- "LL:Cond3:Run3"
LL_8_4_avr$condition <- "LL:Cond3:Run4"
LL_8_5_avr$condition <- "LL:Cond3:Run5"
LL_8_6_avr$condition <- "LL:Cond3:Run6"
LL_8_7_avr$condition <- "LL:Cond3:Run7"
LL_8_8_avr$condition <- "LL:Cond3:Run8"

LL_8_1_avr$environment <- "LunarLander: No Transfer"
LL_8_2_avr$environment <- "LunarLander: No Transfer"
LL_8_3_avr$environment <- "LunarLander: No Transfer"
LL_8_4_avr$environment <- "LunarLander: No Transfer"
LL_8_5_avr$environment <- "LunarLander: No Transfer"
LL_8_6_avr$environment <- "LunarLander: No Transfer"
LL_8_7_avr$environment <- "LunarLander: No Transfer"
LL_8_8_avr$environment <- "LunarLander: No Transfer"

LL_8_1_avr<- select(LL_8_1_avr,-1)
LL_8_2_avr<- select(LL_8_2_avr,-1)
LL_8_3_avr<- select(LL_8_3_avr,-1)
LL_8_4_avr<- select(LL_8_4_avr,-1)
LL_8_5_avr<- select(LL_8_5_avr,-1)
LL_8_6_avr<- select(LL_8_6_avr,-1)
LL_8_7_avr<- select(LL_8_7_avr,-1)
LL_8_8_avr<- select(LL_8_8_avr,-1)



######### LunarLander - Transfer learning ##########
#Load and clean 
TL_8_1 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_8_1.csv", header=FALSE)
TL_8_2 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_8_2.csv", header=FALSE)
TL_8_3 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_8_3.csv", header=FALSE)
TL_8_4 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_8_4.csv", header=FALSE)
TL_8_5 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_8_5.csv", header=FALSE)
TL_8_6 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_8_6.csv", header=FALSE)
TL_8_7 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_8_6.csv", header=FALSE)
TL_8_8 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_8_8.csv", header=FALSE)


#Create df with one column for each simulation scores
colnames(TL_8_1) <- c("sim1", "episode")

TL_8_2 <- select(TL_8_2, 1)
TL_8_3 <- select(TL_8_3, 1)
TL_8_4 <- select(TL_8_4, 1)
TL_8_5 <- select(TL_8_5, 1)
TL_8_6 <- select(TL_8_6, 1)
TL_8_7 <- select(TL_8_7, 1)
TL_8_8 <- select(TL_8_8, 1)

colnames(TL_8_2) <- "sim2"
colnames(TL_8_3) <- "sim3"
colnames(TL_8_4) <- "sim4"
colnames(TL_8_5) <- "sim5"
colnames(TL_8_6) <- "sim6"
colnames(TL_8_7) <- "sim7"
colnames(TL_8_8) <- "sim8"

#Since the agent solved the task in 172 steps in sim4, we add the score on episode 172 to the remaining trials (so that the df has 200 rows as the others)
nrow(TL_8_8) #164 rows
add_8_4 <- data.frame(sim4 = rep(275.44,28))
TL_8_4 <- rbind(TL_8_4, add_8_4)

#Combine all dfs 
TL_df_8 <- cbind(TL_8_1, TL_8_2, TL_8_3, TL_8_4, TL_8_5, TL_8_6, TL_8_7, TL_8_8)

#Add column with summary of the five sims for each episode 
TL_df_8$mean = rowMeans(TL_df_8[,c(-2)])

#Add condition info to this dataset (later to be merged with other)
TL_df_8$condition <- "LunarLander_Transfer"

TL_df_8_mean <- TL_df_8[,c(2,10,11)]

#Make df with column for average score over last 100 episodes
TL_8_1_avr <- avr100(TL_8_1)
TL_8_2_avr <- avr100(TL_8_2)
TL_8_3_avr <- avr100(TL_8_3)
TL_8_4_avr <- avr100(TL_8_4)
TL_8_5_avr <- avr100(TL_8_5)
TL_8_6_avr <- avr100(TL_8_6)
TL_8_7_avr <- avr100(TL_8_7)
TL_8_8_avr <- avr100(TL_8_8)


TL_8_2_avr$episode <- c(0:199)
TL_8_3_avr$episode <- c(0:199)
TL_8_4_avr$episode <- c(0:199)
TL_8_5_avr$episode <- c(0:199)
TL_8_6_avr$episode <- c(0:199)
TL_8_7_avr$episode <- c(0:199)
TL_8_8_avr$episode <- c(0:199)


TL_8_1_avr$condition <- "TL:Cond3:Run1"
TL_8_2_avr$condition <- "TL:Cond3:Run2"
TL_8_3_avr$condition <- "TL:Cond3:Run3"
TL_8_4_avr$condition <- "TL:Cond3:Run4"
TL_8_5_avr$condition <- "TL:Cond3:Run5"
TL_8_6_avr$condition <- "TL:Cond3:Run6"
TL_8_7_avr$condition <- "TL:Cond3:Run7"
TL_8_8_avr$condition <- "TL:Cond3:Run8"

TL_8_1_avr$environment <- "LunarLander: Transfer"
TL_8_2_avr$environment <- "LunarLander: Transfer"
TL_8_3_avr$environment <- "LunarLander: Transfer"
TL_8_4_avr$environment <- "LunarLander: Transfer"
TL_8_5_avr$environment <- "LunarLander: Transfer"
TL_8_6_avr$environment <- "LunarLander: Transfer"
TL_8_7_avr$environment <- "LunarLander: Transfer"
TL_8_8_avr$environment <- "LunarLander: Transfer"

TL_8_1_avr<- select(TL_8_1_avr,-1)
TL_8_2_avr<- select(TL_8_2_avr,-1)
TL_8_3_avr<- select(TL_8_3_avr,-1)
TL_8_4_avr<- select(TL_8_4_avr,-1)
TL_8_5_avr<- select(TL_8_5_avr,-1)
TL_8_6_avr<- select(TL_8_6_avr,-1)
TL_8_7_avr<- select(TL_8_7_avr,-1)
TL_8_8_avr<- select(TL_8_8_avr,-1)

###### Combine all data ############## 
df_8 <- rbind(CP_df_8, LL_df_all, TL_df_8)

df_8_mean <- rbind(CP_df_8_mean, LL_df_all_mean, TL_df_8_mean)

df_8_avr <- rbind(LL_avr_all, TL_8_1_avr,TL_8_2_avr, TL_8_3_avr, TL_8_4_avr, TL_8_5_avr, TL_8_6_avr, TL_8_7_avr, TL_8_8_avr)


########## Plots ############ 
p2_performance_time_cond3 <- ggplot(df_8_mean, aes(episode, mean))+
  geom_line(aes(color=condition))+
  theme_classic()+
  labs(title = "C")+
  theme(legend.title = element_blank())+ 
  geom_hline(yintercept = 200, color="black", linetype="dashed")

#Plot average score over last 100 episodes for each simulation individually
p3_avr100_time_cond3 <- ggplot(df_8_avr, aes(episode, avr100))+
  geom_line(aes(color=environment))+
  labs(title="C")+
  theme_classic()

p4_solved_task_cond3 <- ggplot()+
  geom_line(data=df_8_avr[df_8_avr$condition=="LL:Cond2:Run1",],aes(episode, avr100, color=environment))+
  geom_line(data=df_8_avr[df_8_avr$condition=="LL:Cond2:Run2",],aes(episode, avr100, color=environment))+
  geom_line(data=df_8_avr[df_8_avr$condition=="LL:Cond2:Run3",],aes(episode, avr100, color=environment))+
  geom_line(data=df_8_avr[df_8_avr$condition=="LL:Cond2:Run4",],aes(episode, avr100, color=environment))+
  geom_line(data=df_8_avr[df_8_avr$condition=="LL:Cond2:Run5",],aes(episode, avr100, color=environment))+
  geom_line(data=df_8_avr[df_8_avr$condition=="LL:Cond2:Run6",],aes(episode, avr100, color=environment))+
  geom_line(data=df_8_avr[df_8_avr$condition=="LL:Cond2:Run7",],aes(episode, avr100, color=environment))+
  geom_line(data=df_8_avr[df_8_avr$condition=="LL:Cond2:Run8",],aes(episode, avr100, color=environment))+
  geom_line(data=df_8_avr[df_8_avr$condition=="TL:Cond3:Run1",],aes(episode, avr100, color=environment))+
  geom_line(data=df_8_avr[df_8_avr$condition=="TL:Cond3:Run2",],aes(episode, avr100, color=environment))+
  geom_line(data=df_8_avr[df_8_avr$condition=="TL:Cond3:Run3",],aes(episode, avr100, color=environment))+
  geom_line(data=df_8_avr[df_8_avr$condition=="TL:Cond3:Run4",],aes(episode, avr100, color=environment))+
  geom_line(data=df_8_avr[df_8_avr$condition=="TL:Cond3:Run5",],aes(episode, avr100, color=environment))+
  geom_line(data=df_8_avr[df_8_avr$condition=="TL:Cond3:Run6",],aes(episode, avr100, color=environment))+
  geom_line(data=df_8_avr[df_8_avr$condition=="TL:Cond3:Run7",],aes(episode, avr100, color=environment))+
  geom_line(data=df_8_avr[df_8_avr$condition=="TL:Cond3:Run8",],aes(episode, avr100, color=environment))+
  ylim(0,250)+
  xlim(100,200)+
  geom_hline(yintercept = 200, color="black", linetype="dashed")+
  labs(title="C")+
  theme_classic()+ 
  theme(legend.title = element_blank())


```

#Full data (5 sims) - Simulation 9 - 3 hidden layers, transfer from layer 3 only
```{r}
######### CartPole ##########
#Load and clean 
CP_9_1 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_9_1.csv", header=FALSE)
CP_9_2 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_9_2.csv", header=FALSE)
CP_9_3 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_9_3.csv", header=FALSE)
CP_9_4 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_9_4.csv", header=FALSE)
CP_9_5 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_9_5.csv", header=FALSE)
CP_9_6 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_9_6.csv", header=FALSE)
CP_9_7 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_9_7.csv", header=FALSE)
CP_9_8 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossCartPole_9_8.csv", header=FALSE)


#Create df with one column for each simulation scores
colnames(CP_9_1) <- c("sim1", "episode")

CP_9_2 <- select(CP_9_2, 1)
CP_9_3 <- select(CP_9_3, 1)
CP_9_4 <- select(CP_9_4, 1)
CP_9_5 <- select(CP_9_5, 1)
CP_9_6 <- select(CP_9_6, 1)
CP_9_7 <- select(CP_9_7, 1)
CP_9_8 <- select(CP_9_8, 1)

colnames(CP_9_2) <- "sim2"
colnames(CP_9_3) <- "sim3"
colnames(CP_9_4) <- "sim4"
colnames(CP_9_5) <- "sim5"
colnames(CP_9_6) <- "sim6"
colnames(CP_9_7) <- "sim7"
colnames(CP_9_8) <- "sim8"

CP_df_9 <- cbind(CP_9_1, CP_9_2, CP_9_3, CP_9_4, CP_9_5, CP_9_6, CP_9_7, CP_9_8)

#Add column with summary of the five sims for each episode 
CP_df_9$mean = rowMeans(CP_df_9[,c(-2)])

#Add condition info to this dataset (later to be merged with other)
CP_df_9$condition <- "CartPole"

CP_df_9_mean <- CP_df_9[,c(2,10,11)]


######### LunarLander - no Transfer ##########
#Make df with column for average score over last 100 episodes
LL_9_1_avr <- avr100(LL_9_1)
LL_9_2_avr <- avr100(LL_9_2)
LL_9_3_avr <- avr100(LL_9_3)
LL_9_4_avr <- avr100(LL_9_4)
LL_9_5_avr <- avr100(LL_9_5)
LL_9_6_avr <- avr100(LL_9_6)
LL_9_7_avr <- avr100(LL_9_7)
LL_9_8_avr <- avr100(LL_9_8)

LL_9_1_avr$episode <- c(0:199)
LL_9_2_avr$episode <- c(0:199)
LL_9_3_avr$episode <- c(0:199)
LL_9_4_avr$episode <- c(0:199)
LL_9_5_avr$episode <- c(0:199)
LL_9_6_avr$episode <- c(0:199)
LL_9_7_avr$episode <- c(0:199)
LL_9_8_avr$episode <- c(0:199)


LL_9_1_avr$condition <- "LL:Cond4:Run1"
LL_9_2_avr$condition <- "LL:Cond4:Run2"
LL_9_3_avr$condition <- "LL:Cond4:Run3"
LL_9_4_avr$condition <- "LL:Cond4:Run4"
LL_9_5_avr$condition <- "LL:Cond4:Run5"
LL_9_6_avr$condition <- "LL:Cond4:Run6"
LL_9_7_avr$condition <- "LL:Cond4:Run7"
LL_9_8_avr$condition <- "LL:Cond4:Run8"

LL_9_1_avr$environment <- "LunarLander: No Transfer"
LL_9_2_avr$environment <- "LunarLander: No Transfer"
LL_9_3_avr$environment <- "LunarLander: No Transfer"
LL_9_4_avr$environment <- "LunarLander: No Transfer"
LL_9_5_avr$environment <- "LunarLander: No Transfer"
LL_9_6_avr$environment <- "LunarLander: No Transfer"
LL_9_7_avr$environment <- "LunarLander: No Transfer"
LL_9_8_avr$environment <- "LunarLander: No Transfer"

LL_9_1_avr<- select(LL_9_1_avr,-1)
LL_9_2_avr<- select(LL_9_2_avr,-1)
LL_9_3_avr<- select(LL_9_3_avr,-1)
LL_9_4_avr<- select(LL_9_4_avr,-1)
LL_9_5_avr<- select(LL_9_5_avr,-1)
LL_9_6_avr<- select(LL_9_6_avr,-1)
LL_9_7_avr<- select(LL_9_7_avr,-1)
LL_9_8_avr<- select(LL_9_8_avr,-1)



######### LunarLander - Transfer learning ##########
#Load and clean 
TL_9_1 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_9_1.csv", header=FALSE)
TL_9_2 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_9_2.csv", header=FALSE)
TL_9_3 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_9_3.csv", header=FALSE)
TL_9_4 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_9_4.csv", header=FALSE)
TL_9_5 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_9_5.csv", header=FALSE)
TL_9_6 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_9_6.csv", header=FALSE)
TL_9_7 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_9_7.csv", header=FALSE)
TL_9_8 <- read.csv("~/Dropbox/ExamProject - DQN Transfer Learning/lossTransfer_CPtoLL_9_8.csv", header=FALSE)


#Create df with one column for each simulation scores
colnames(TL_9_1) <- c("sim1", "episode")

TL_9_2 <- select(TL_9_2, 1)
TL_9_3 <- select(TL_9_3, 1)
TL_9_4 <- select(TL_9_4, 1)
TL_9_5 <- select(TL_9_5, 1)
TL_9_6 <- select(TL_9_6, 1)
TL_9_7 <- select(TL_9_7, 1)
TL_9_8 <- select(TL_9_8, 1)

colnames(TL_9_2) <- "sim2"
colnames(TL_9_3) <- "sim3"
colnames(TL_9_4) <- "sim4"
colnames(TL_9_5) <- "sim5"
colnames(TL_9_6) <- "sim6"
colnames(TL_9_7) <- "sim7"
colnames(TL_9_8) <- "sim8"

#Since the agent solved the task in 177 steps in sim2, we add the score on episode 177 to the remaining trials (so that the df has 200 rows as the others)
nrow(TL_9_8) #177 rows
add_9_2 <- data.frame(sim2 = rep(231.13,23))
TL_9_2 <- rbind(TL_9_2, add_9_2)

#Combine all dfs 
TL_df_9 <- cbind(TL_9_1, TL_9_2, TL_9_3, TL_9_4, TL_9_5, TL_9_6, TL_9_7, TL_9_8)

#Add column with summary of the five sims for each episode 
TL_df_9$mean = rowMeans(TL_df_9[,c(-2)])

#Add condition info to this dataset (later to be merged with other)
TL_df_9$condition <- "LunarLander_Transfer"

TL_df_9_mean <- TL_df_9[,c(2,10,11)]

#Make df with column for average score over last 100 episodes
TL_9_1_avr <- avr100(TL_9_1)
TL_9_2_avr <- avr100(TL_9_2)
TL_9_3_avr <- avr100(TL_9_3)
TL_9_4_avr <- avr100(TL_9_4)
TL_9_5_avr <- avr100(TL_9_5)
TL_9_6_avr <- avr100(TL_9_6)
TL_9_7_avr <- avr100(TL_9_7)
TL_9_8_avr <- avr100(TL_9_8)


TL_9_2_avr$episode <- c(0:199)
TL_9_3_avr$episode <- c(0:199)
TL_9_4_avr$episode <- c(0:199)
TL_9_5_avr$episode <- c(0:199)
TL_9_6_avr$episode <- c(0:199)
TL_9_7_avr$episode <- c(0:199)
TL_9_8_avr$episode <- c(0:199)


TL_9_1_avr$condition <- "TL:Cond4:Run1"
TL_9_2_avr$condition <- "TL:Cond4:Run2"
TL_9_3_avr$condition <- "TL:Cond4:Run3"
TL_9_4_avr$condition <- "TL:Cond4:Run4"
TL_9_5_avr$condition <- "TL:Cond4:Run5"
TL_9_6_avr$condition <- "TL:Cond4:Run6"
TL_9_7_avr$condition <- "TL:Cond4:Run7"
TL_9_8_avr$condition <- "TL:Cond4:Run8"

TL_9_1_avr$environment <- "LunarLander: Transfer"
TL_9_2_avr$environment <- "LunarLander: Transfer"
TL_9_3_avr$environment <- "LunarLander: Transfer"
TL_9_4_avr$environment <- "LunarLander: Transfer"
TL_9_5_avr$environment <- "LunarLander: Transfer"
TL_9_6_avr$environment <- "LunarLander: Transfer"
TL_9_7_avr$environment <- "LunarLander: Transfer"
TL_9_8_avr$environment <- "LunarLander: Transfer"

TL_9_1_avr<- select(TL_9_1_avr,-1)
TL_9_2_avr<- select(TL_9_2_avr,-1)
TL_9_3_avr<- select(TL_9_3_avr,-1)
TL_9_4_avr<- select(TL_9_4_avr,-1)
TL_9_5_avr<- select(TL_9_5_avr,-1)
TL_9_6_avr<- select(TL_9_6_avr,-1)
TL_9_7_avr<- select(TL_9_7_avr,-1)
TL_9_8_avr<- select(TL_9_8_avr,-1)

###### Combine all data ############## 
df_9 <- rbind(CP_df_9, LL_df_9, TL_df_9)

df_9_mean <- rbind(CP_df_9_mean, LL_df_all_mean, TL_df_9_mean)

df_9_avr <- rbind(LL_avr_all, TL_9_1_avr,TL_9_2_avr, TL_9_3_avr, TL_9_4_avr, TL_9_5_avr, TL_9_6_avr, TL_9_7_avr, TL_9_8_avr)



########## Plots ############ 
p2_performance_time_cond4 <- ggplot(df_9_mean, aes(episode, mean))+
  geom_line(aes(color=condition))+
  theme_classic()+
  labs(title = "D")+ 
  theme(legend.title = element_blank())+ 
  geom_hline(yintercept = 200, color="black", linetype="dashed")

#Plot average score over last 100 episodes for each simulation individually
p3_avr100_time_cond4 <- ggplot(df_9_avr, aes(episode, avr100))+
  geom_line(aes(color=environment))+
  labs(title="D")+
  theme_classic()


p4_solved_task_cond4 <- ggplot()+
  geom_line(data=df_9_avr[df_9_avr$condition=="LL:Cond2:Run1",],aes(episode, avr100, color=environment))+
  geom_line(data=df_9_avr[df_9_avr$condition=="LL:Cond2:Run2",],aes(episode, avr100, color=environment))+
  geom_line(data=df_9_avr[df_9_avr$condition=="LL:Cond2:Run3",],aes(episode, avr100, color=environment))+
  geom_line(data=df_9_avr[df_9_avr$condition=="LL:Cond2:Run4",],aes(episode, avr100, color=environment))+
  geom_line(data=df_9_avr[df_9_avr$condition=="LL:Cond2:Run5",],aes(episode, avr100, color=environment))+
  geom_line(data=df_9_avr[df_9_avr$condition=="LL:Cond2:Run6",],aes(episode, avr100, color=environment))+
  geom_line(data=df_9_avr[df_9_avr$condition=="LL:Cond2:Run7",],aes(episode, avr100, color=environment))+
  geom_line(data=df_9_avr[df_9_avr$condition=="LL:Cond2:Run8",],aes(episode, avr100, color=environment))+
  geom_line(data=df_9_avr[df_9_avr$condition=="TL:Cond4:Run1",],aes(episode, avr100, color=environment))+
  geom_line(data=df_9_avr[df_9_avr$condition=="TL:Cond4:Run2",],aes(episode, avr100, color=environment))+
  geom_line(data=df_9_avr[df_9_avr$condition=="TL:Cond4:Run3",],aes(episode, avr100, color=environment))+
  geom_line(data=df_9_avr[df_9_avr$condition=="TL:Cond4:Run4",],aes(episode, avr100, color=environment))+
  geom_line(data=df_9_avr[df_9_avr$condition=="TL:Cond4:Run5",],aes(episode, avr100, color=environment))+
  geom_line(data=df_9_avr[df_9_avr$condition=="TL:Cond4:Run6",],aes(episode, avr100, color=environment))+
  geom_line(data=df_9_avr[df_9_avr$condition=="TL:Cond4:Run7",],aes(episode, avr100, color=environment))+
  geom_line(data=df_9_avr[df_9_avr$condition=="TL:Cond4:Run8",],aes(episode, avr100, color=environment))+
  ylim(0,250)+
  xlim(100,200)+
  geom_hline(yintercept = 200, color="black", linetype="dashed")+
  labs(title="D")+
  theme_classic()+ 
  theme(legend.title = element_blank())



```

#Mean score across all trials of all models for each condition - Plot 

```{r}
#Condition 1 - mean scores 
CP_6_mean <- mean(df_6[df_6$condition=="CartPole",][,10])
LL_6_mean <- mean(df_6[df_6$condition=="LunarLander",][,10])
TL_6_mean <- mean(df_6[df_6$condition=="LunarLander_Transfer",][,10])

#Condition 2 - mean scores 
CP_7_mean <- mean(df_7_mean[df_7_mean$condition=="CartPole",][,2])
LL_7_mean <- mean(df_7_mean[df_7_mean$condition=="LunarLander",][,2])
TL_7_mean <- mean(df_7_mean[df_7_mean$condition=="LunarLander_Transfer",][,2])

#Condition 3 - mean scores 
CP_8_mean <- mean(df_8_mean[df_8_mean$condition=="CartPole",][,2])
LL_8_mean <- mean(df_8_mean[df_8_mean$condition=="LunarLander",][,2])
TL_8_mean <- mean(df_8_mean[df_8_mean$condition=="LunarLander_Transfer",][,2])

#Condition 4 - mean scores 
CP_9_mean <- mean(df_9_mean[df_9_mean$condition=="CartPole",][,2])
LL_9_mean <- mean(df_9_mean[df_9_mean$condition=="LunarLander",][,2])
TL_9_mean <- mean(df_9_mean[df_9_mean$condition=="LunarLander_Transfer",][,2])

#Combine all in one df 
mean_6 <- data.frame(model = c("CartPole", "LunarLander", "LunarLander_Transfer"), mean=c(CP_6_mean, LL_6_mean, TL_6_mean))

mean_7 <- data.frame(model = c("CartPole", "LunarLander", "LunarLander_Transfer"), mean=c(CP_7_mean, LL_7_mean, TL_7_mean))

mean_8 <- data.frame(model = c("CartPole", "LunarLander", "LunarLander_Transfer"), mean=c(CP_8_mean, LL_8_mean, TL_8_mean))

mean_9 <- data.frame(model = c("CartPole", "LunarLander", "LunarLander_Transfer"), mean=c(CP_9_mean, LL_9_mean, TL_9_mean))

mean_6$condition <- "Cond1"
mean_7$condition <- "Cond2"
mean_8$condition <- "Cond3"
mean_9$condition <- "Cond4"

mean_all <- rbind(mean_6, mean_7, mean_8, mean_9)

#Make plot 
p5_avr_reward <- ggplot(mean_all, aes(condition,mean, fill=model))+
  geom_bar(stat="identity", position=position_dodge())+
  theme_minimal()+ 
  scale_fill_brewer(palette = "BuPu")+ 
  labs(title="A")




```

#Plot mean average over last 100 episodes for each model in each condition 

```{r}
#Condition 1
CP_6_1_avr <- avr100(CP_6_1)
CP_6_2_avr <- avr100(CP_6_2)
CP_6_3_avr <- avr100(CP_6_3)
CP_6_4_avr <- avr100(CP_6_4)
CP_6_5_avr <- avr100(CP_6_5)
CP_6_6_avr <- avr100(CP_6_6)
CP_6_7_avr <- avr100(CP_6_7)
CP_6_8_avr <- avr100(CP_6_8)

colnames(CP_6_1_avr) <- c("x", "episode", "sim1")
colnames(CP_6_2_avr) <- c("x", "sim2")
colnames(CP_6_3_avr) <- c("x", "sim3")
colnames(CP_6_4_avr) <- c("x", "sim4")
colnames(CP_6_5_avr) <- c("x", "sim5")
colnames(CP_6_6_avr) <- c("x", "sim6")
colnames(CP_6_7_avr) <- c("x", "sim7")
colnames(CP_6_8_avr) <- c("x", "sim8")

CP_6_1_avr <- CP_6_1_avr[,-1]
CP_6_2_avr <- CP_6_2_avr[,-1]
CP_6_3_avr <- CP_6_3_avr[,-1]
CP_6_4_avr <- CP_6_4_avr[,-1]
CP_6_5_avr <- CP_6_5_avr[,-1]
CP_6_6_avr <- CP_6_6_avr[,-1]
CP_6_7_avr <- CP_6_7_avr[,-1]
CP_6_8_avr <- CP_6_8_avr[,-1]


CP_6_avr <- cbind(CP_6_1_avr, CP_6_2_avr, CP_6_3_avr, CP_6_4_avr, CP_6_5_avr, CP_6_6_avr, CP_6_7_avr, CP_6_8_avr)
CP_6_avr100 <- rowMeans(CP_6_avr[200,2:6])

LL <- df_6_avr[df_6_avr$environment == "LunarLander: No transfer" & df_6_avr$episode==199,]
LL_6_avr100 <- mean(LL[,2])

TL <- df_6_avr[df_6_avr$environment == "LunarLander: Transfer" & df_6_avr$episode==199,]
TL_6_avr100 <- mean(TL[,2])

avr6 <- data.frame(model=c("CartPole", "LunarLander", "LunarLander_Transfer"), avr100=c(CP_6_avr100, LL_6_avr100, TL_6_avr100))

avr6$condition <- "Cond1"


#Condition 2
CP_7_1_avr <- avr100(CP_7_1)
CP_7_2_avr <- avr100(CP_7_2)
CP_7_3_avr <- avr100(CP_7_3)
CP_7_4_avr <- avr100(CP_7_4)
CP_7_5_avr <- avr100(CP_7_5)
CP_7_6_avr <- avr100(CP_7_6)
CP_7_7_avr <- avr100(CP_7_7)
CP_7_8_avr <- avr100(CP_7_8)

colnames(CP_7_1_avr) <- c("x", "episode", "sim1")
colnames(CP_7_2_avr) <- c("x", "sim2")
colnames(CP_7_3_avr) <- c("x", "sim3")
colnames(CP_7_4_avr) <- c("x", "sim4")
colnames(CP_7_5_avr) <- c("x", "sim5")
colnames(CP_7_6_avr) <- c("x", "sim6")
colnames(CP_7_7_avr) <- c("x", "sim7")
colnames(CP_7_8_avr) <- c("x", "sim8")

CP_7_1_avr <- CP_7_1_avr[,-1]
CP_7_2_avr <- CP_7_2_avr[,-1]
CP_7_3_avr <- CP_7_3_avr[,-1]
CP_7_4_avr <- CP_7_4_avr[,-1]
CP_7_5_avr <- CP_7_5_avr[,-1]
CP_7_6_avr <- CP_7_6_avr[,-1]
CP_7_7_avr <- CP_7_7_avr[,-1]
CP_7_8_avr <- CP_7_8_avr[,-1]

CP_7_avr <- cbind(CP_7_1_avr, CP_7_2_avr, CP_7_3_avr, CP_7_4_avr, CP_7_5_avr, CP_7_6_avr, CP_7_7_avr, CP_7_8_avr)
CP_7_avr100 <- rowMeans(CP_7_avr[200,2:6])

TL <- df_7_avr[df_7_avr$environment == "LunarLander: Transfer" & df_7_avr$episode==199,]
TL_7_avr100 <- mean(TL[,4])

avr7 <- data.frame(model=c("CartPole", "LunarLander", "LunarLander_Transfer"), avr100=c(CP_7_avr100, LL_avr100, TL_7_avr100))

avr7$condition <- "Cond2"


#Condition 3
CP_8_1_avr <- avr100(CP_8_1)
CP_8_2_avr <- avr100(CP_8_2)
CP_8_3_avr <- avr100(CP_8_3)
CP_8_4_avr <- avr100(CP_8_4)
CP_8_5_avr <- avr100(CP_8_5)
CP_8_6_avr <- avr100(CP_8_6)
CP_8_7_avr <- avr100(CP_8_7)
CP_8_8_avr <- avr100(CP_8_8)

colnames(CP_8_1_avr) <- c("x", "episode", "sim1")
colnames(CP_8_2_avr) <- c("x", "sim2")
colnames(CP_8_3_avr) <- c("x", "sim3")
colnames(CP_8_4_avr) <- c("x", "sim4")
colnames(CP_8_5_avr) <- c("x", "sim5")
colnames(CP_8_6_avr) <- c("x", "sim6")
colnames(CP_8_7_avr) <- c("x", "sim7")
colnames(CP_8_8_avr) <- c("x", "sim8")

CP_8_1_avr <- CP_8_1_avr[,-1]
CP_8_2_avr <- CP_8_2_avr[,-1]
CP_8_3_avr <- CP_8_3_avr[,-1]
CP_8_4_avr <- CP_8_4_avr[,-1]
CP_8_5_avr <- CP_8_5_avr[,-1]
CP_8_6_avr <- CP_8_6_avr[,-1]
CP_8_7_avr <- CP_8_7_avr[,-1]
CP_8_8_avr <- CP_8_8_avr[,-1]

CP_8_avr <- cbind(CP_8_1_avr, CP_8_2_avr, CP_8_3_avr, CP_8_4_avr, CP_8_5_avr)
CP_8_avr100 <- rowMeans(CP_8_avr[200,2:6])

TL <- df_8_avr[df_8_avr$environment == "LunarLander: Transfer" & df_8_avr$episode==199,]
TL_8_avr100 <- mean(TL[,4])

avr8 <- data.frame(model=c("CartPole", "LunarLander", "LunarLander_Transfer"), avr100=c(CP_8_avr100, LL_avr100, TL_8_avr100))

avr8$condition <- "Cond3"


#Condition 4
CP_9_1_avr <- avr100(CP_9_1)
CP_9_2_avr <- avr100(CP_9_2)
CP_9_3_avr <- avr100(CP_9_3)
CP_9_4_avr <- avr100(CP_9_4)
CP_9_5_avr <- avr100(CP_9_5)
CP_9_6_avr <- avr100(CP_9_6)
CP_9_7_avr <- avr100(CP_9_7)
CP_9_8_avr <- avr100(CP_9_8)

colnames(CP_9_1_avr) <- c("x", "episode", "sim1")
colnames(CP_9_2_avr) <- c("x", "sim2")
colnames(CP_9_3_avr) <- c("x", "sim3")
colnames(CP_9_4_avr) <- c("x", "sim4")
colnames(CP_9_5_avr) <- c("x", "sim5")
colnames(CP_9_6_avr) <- c("x", "sim6")
colnames(CP_9_7_avr) <- c("x", "sim7")
colnames(CP_9_8_avr) <- c("x", "sim8")

CP_9_1_avr <- CP_9_1_avr[,-1]
CP_9_2_avr <- CP_9_2_avr[,-1]
CP_9_3_avr <- CP_9_3_avr[,-1]
CP_9_4_avr <- CP_9_4_avr[,-1]
CP_9_5_avr <- CP_9_5_avr[,-1]
CP_9_6_avr <- CP_9_6_avr[,-1]
CP_9_7_avr <- CP_9_7_avr[,-1]
CP_9_8_avr <- CP_9_8_avr[,-1]

CP_9_avr <- cbind(CP_9_1_avr, CP_9_2_avr, CP_9_3_avr, CP_9_4_avr, CP_9_5_avr)
CP_9_avr100 <- rowMeans(CP_9_avr[200,2:6])

TL <- df_9_avr[df_9_avr$environment == "LunarLander: Transfer" & df_9_avr$episode==199,]
TL_9_avr100 <- mean(TL[,4])

avr9 <- data.frame(model=c("CartPole", "LunarLander", "LunarLander_Transfer"), avr100=c(CP_9_avr100, LL_avr100, TL_9_avr100))

avr9$condition <- "Cond4"


#Bind all data together 
avr_all <- rbind(avr6, avr7, avr8, avr9)

#Plot 
p5_avr100_barplot <- ggplot(avr_all, aes(condition,avr100, fill=model))+
  geom_bar(stat="identity", position=position_dodge())+
  theme_minimal()+ 
  scale_fill_brewer(palette = "BuPu")+ 
  labs(title="B")
```

